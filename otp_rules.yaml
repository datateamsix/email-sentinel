# Email Sentinel - OTP/2FA Code Detection Configuration
#
# This file controls automatic detection and extraction of one-time passwords
# and two-factor authentication codes from emails.

# Enable/disable OTP detection
enabled: true

# How long OTP codes remain active before expiring
# Format: "5m" (minutes), "300s" (seconds), "1h" (hours)
expiry_duration: "5m"

# Minimum confidence score to treat as valid OTP (0.0 to 1.0)
# Higher = fewer false positives, but might miss some codes
# Recommended: 0.7 for balanced detection
confidence_threshold: 0.7

# Auto-copy most recent OTP to clipboard when detected
# Set to true for instant clipboard access
auto_copy_to_clipboard: false

# Auto-clear clipboard after this duration (security feature)
# Prevents codes from staying in clipboard too long
clipboard_auto_clear: "2m"

# Sender domains known to send OTP codes
# Emails from these domains get +0.1 confidence bonus
# Add domains without "www" or protocol
trusted_otp_senders:
  # Major platforms
  - accounts.google.com
  - noreply@github.com
  - amazon.com
  - microsoft.com
  - paypal.com
  - apple.com
  - account.microsoft.com
  - security@facebookmail.com

  # Financial institutions
  - bankofamerica.com
  - chase.com
  - wellsfargo.com
  - citibank.com
  - capitalone.com

  # Tech & Services
  - twitter.com
  - linkedin.com
  - dropbox.com
  - slack.com
  - discord.com
  - spotify.com
  - netflix.com

  # Generic patterns (match any domain)
  - noreply@
  - no-reply@
  - security@
  - verify@
  - notifications@

# Custom OTP patterns (advanced users, optional)
# Add domain-specific or custom formats here
custom_patterns:
  # Example: Match codes like "Code: ABC123"
  - name: "custom_alphanumeric"
    regex: "Code:\\s*([A-Z0-9]{6})"
    confidence: 0.8

  # Example: Match 8-digit codes with prefix
  # - name: "bank_code"
  #   regex: "verification code is:\\s*(\\d{8})"
  #   confidence: 0.9

# Built-in Patterns (automatically applied, listed here for reference)
# These are hardcoded in the application but can be overridden with custom_patterns
#
# 1. Standard 6-digit: "123456" or "code: 123456"
# 2. GitHub-style: "Your GitHub verification code is 123456"
# 3. Google-style: "G-123456" or "verification code: 123456"
# 4. Verification code: "verification code is 123456"
# 5. Security code: "security code: 123456"
# 6. Confirmation code: "confirmation code: 123456"
# 7. PIN code: "PIN: 1234" or "PIN code: 1234"
# 8. Token: "token: abc123xyz"
# 9. OTP explicit: "OTP: 123456" or "Your OTP is 123456"
# 10. Two-factor: "2FA code: 123456"

# False Positive Prevention (built-in)
# The following patterns are automatically rejected:
# - Sequential numbers: 123456, 234567, etc.
# - Repeating numbers: 111111, 000000, etc.
# - Invoice/order numbers (detected by context)
# - Phone numbers (detected by context)
